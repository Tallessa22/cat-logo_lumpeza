<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Catálogo de Produtos</title>
  <script src="https://cdn.jsdelivr.net/npm/contentful@latest/dist/contentful.browser.min.js"></script>
  <style>
    body { font-family: Arial; padding: 20px; }
    .card { border: 1px solid #ccc; border-radius: 10px; padding: 10px; margin: 10px; width: 250px; display: inline-block; vertical-align: top; }
    .card img { width: 100%; height: auto; border-radius: 8px; }
    .popup { display: none; position: fixed; top: 10%; left: 10%; width: 80%; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.5); z-index: 1000; }
    .popup img { max-width: 100%; margin: 5px 0; }
    .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 900; }
    .close-btn { float: right; cursor: pointer; font-size: 18px; }
  </style>
</head>
<body>
  <h1>Catálogo de Produtos</h1>
  <input type="text" id="search" placeholder="Buscar produto..." oninput="renderCards()">
  <div id="catalogo"></div>

  <div class="overlay" id="overlay"></div>
  <div class="popup" id="popup">
    <span class="close-btn" onclick="closePopup()">✖</span>
    <div id="popupContent"></div>
  </div>

  <script>
    const client = contentful.createClient({
      space: '9ujsgy8e3bip',
      accessToken: 'YKWRxsqnKRfD2nwFOpmzE6TG4CGLPk1OsBFFG0JzQ2o'
    });

    let produtos = [];

    client.getEntries({ content_type: 'saboLquido' })
      .then(response => {
        produtos = response.items;
        renderCards();
      })
      .catch(console.error);

    function renderCards() {
      const container = document.getElementById('catalogo');
      const busca = document.getElementById('search').value.toLowerCase();
      container.innerHTML = '';

      produtos
        .filter(item => item.fields.saboLquido?.toLowerCase().includes(busca))
        .forEach(item => {
          const nome = item.fields.saboLquido;
          const imgUrl = item.fields.imagens?.[0]?.fields?.file?.url;
          const preco = item.fields.preo;

          const card = document.createElement('div');
          card.className = 'card';
          card.innerHTML = `
            <img src="https:${imgUrl}" alt="${nome}">
            <h3>${nome}</h3>
            <p><strong>Preço:</strong> R$ ${preco}</p>
            <button onclick='openPopup(${JSON.stringify(item.fields)})'>Ver Detalhes</button>
            <a href="https://wa.me/5511943291778?text=Tenho%20interesse%20no%20produto:%20${encodeURIComponent(nome)}" target="_blank">
              <button>Tenho Interesse</button>
            </a>
          `;
          container.appendChild(card);
        });
    }

    function openPopup(fields) {
      const popup = document.getElementById('popup');
      const overlay = document.getElementById('overlay');
      const content = document.getElementById('popupContent');

      content.innerHTML = `
        <h2>${fields.saboLquido}</h2>
        <p><strong>Descrição:</strong> ${fields.descrio}</p>
        <p><strong>Características:</strong> ${fields.caractersticas.join(', ')}</p>
        <p><strong>Estoque:</strong> ${fields.estoque}</p>
        <div>
          ${(fields.imagens || []).map(img => `<img src="https:${img.fields.file.url}" />`).join('')}
        </div>
      `;

      overlay.style.display = 'block';
      popup.style.display = 'block';
    }

    function closePopup() {
      document.getElementById('popup').style.display = 'none';
      document.getElementById('overlay').style.display = 'none';
    }
  </script>
</body>
</html>
